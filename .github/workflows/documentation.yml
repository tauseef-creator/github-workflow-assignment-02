name: Documentation Deployment

on:
  push:
    branches:
      - master

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2
      with:
        persist-credentials: false

    - name: Install pandoc
      run: sudo apt-get install -y pandoc

    - name: Convert API.md to HTML
      run: pandoc -s docs/API.md -o API.html

    - name: Create and checkout gh-pages branch
      run: |
        git config --global user.email "action@github.com"
        git config --global user.name "GitHub Action"
        git checkout --orphan gh-pages
        git rm -rf .

    - name: Copy API.html to gh-pages branch
      run: cp API.html .

    - name: Commit and push changes
      run: |
        git add .
        git commit -m "Update API documentation"
        git push origin gh-pages
